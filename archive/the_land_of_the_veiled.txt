Remake cuz I CTE&#39;d